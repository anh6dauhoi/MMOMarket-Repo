@startuml Top-Up (Coin Deposit) - Class Diagram
!define ENTITY_COLOR #E8F5E9

skinparam backgroundColor #FAFAFA
skinparam linetype ortho
skinparam nodesep 120
skinparam ranksep 120
skinparam padding 15
skinparam classBackgroundColor ENTITY_COLOR
skinparam classBorderColor #81C784
skinparam arrowThickness 1.5

' Title
title Top-Up (Coin Deposit) - Class Diagram\nEntity Level - Relationships Focus

' =============== ENTITIES ===============

class User <<Entity>> {
}

class CoinDeposit <<Entity>> {
}

' =============== LAYOUT HINTS (Hidden) ===============

User -[hidden]right- CoinDeposit

' =============== MAIN RELATIONSHIPS ===============

User "1" -right-> "0..*" CoinDeposit : <<has>>

' =============== LEGEND ===============

legend bottom
  **Relationship Types:**
  | Symbol | Meaning |
  | ━━━━━▶ | Association (solid) |

  **Top-Up Flow:**
  1. User views Top-Up page (get depositCode)
  2. User transfers money to system bank with depositCode
  3. SePay webhook receives bank notification
  4. System validates & checks duplicate transaction
  5. System creates CoinDeposit & adds coins to User
  6. User receives notification

  **Key Points:**
  - depositCode: Unique identifier (MMO + base36 + CRC32)
  - 1 VND = 1 Coin
  - Duplicate prevention via sepayTransactionId
  - Webhook-based automatic processing
end legend

@enduml

